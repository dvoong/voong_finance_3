(function(){function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}return e})()({1:[function(require,module,exports){
"use strict";
exports.__esModule = true;
console.log('home.js');
// =========
// Tool Tip
// =========
var tooltip_1 = require("./tooltip");
var balance_chart = null;
var tooltips = null;
// =========
// Canvas
// =========
var Canvas = /** @class */ (function () {
    function Canvas(selection) {
        this.selection = selection;
        this.height = this.get_height();
        this.width = this.get_width();
    }
    Canvas.prototype.get_width = function () {
        return parseInt(this.selection.style('width'));
    };
    Canvas.prototype.get_height = function () {
        return parseInt(this.selection.style('height'));
    };
    return Canvas;
}());
// =========
// X-Axis
// =========
var XAxis = /** @class */ (function () {
    function XAxis(selection) {
        this.selection = selection;
        this.scale = d3.scaleUtc();
    }
    ;
    XAxis.prototype.set_range = function (range) {
        this.scale.range(range);
    };
    XAxis.prototype.set_domain = function (domain) {
        this.scale.domain(domain);
    };
    XAxis.prototype.set_position = function (position) {
        this.position = position;
    };
    XAxis.prototype.draw = function () {
        var x = this.position[0];
        var y = this.position[1];
        var scale = this.scale;
        this.selection.attr('transform', 'translate(' + x + ', ' + y + ')');
        this.selection.transition().call(d3.axisBottom(scale));
        var now = new Date();
        var today = new Date(Date.UTC(now.getFullYear(), now.getMonth(), now.getDate()));
        this.selection
            .selectAll('g.tick text')
            .filter(function (d) {
            return d.getTime() == today.getTime();
        })
            .attr('fill', 'blue');
    };
    return XAxis;
}());
// =========
// Y-Axis
// =========
var YAxis = /** @class */ (function () {
    function YAxis(selection) {
        this.selection = selection;
        this.scale = d3.scaleLinear();
    }
    YAxis.prototype.set_range = function (range) {
        this.scale.range(range);
    };
    YAxis.prototype.set_domain = function (domain) {
        this.scale.domain(domain);
    };
    YAxis.prototype.set_position = function (position) {
        this.position = position;
    };
    YAxis.prototype.draw = function () {
        var x = this.position[0];
        var y = this.position[1];
        var scale = this.scale;
        function tick_formatter(t) {
            return 'Â£' + t.toLocaleString();
        }
        this.selection.attr('transform', 'translate(' + x + ', ' + y + ')');
        this.selection.transition().call(d3.axisLeft(scale).tickFormat(tick_formatter));
    };
    return YAxis;
}());
// ==============
// Balance Chart
// ==============
var BalanceChart = /** @class */ (function () {
    function BalanceChart(selection, balances, padding) {
        if (padding === void 0) { padding = { top: 10, left: 60, right: 20, bottom: 40 }; }
        this.selection = selection;
        this.balances = balances;
        this.padding = padding;
        this.canvas = new Canvas(this.selection.select('#canvas'));
        this.plot_area = this.canvas.selection.select('#plot-area');
        this.x_axis = new XAxis(this.canvas.selection.select('#x-axis'));
        this.y_axis = new YAxis(this.canvas.selection.select('#y-axis'));
        this.set_x_axis_position();
        this.set_x_axis_range();
        this.set_x_axis_domain();
        this.set_y_axis_position();
        this.set_y_axis_range();
        this.set_y_axis_domain();
    }
    BalanceChart.prototype.resize = function () {
        this.canvas.width = this.canvas.get_width();
        this.canvas.height = this.canvas.get_height();
        this.set_x_axis_range();
        this.set_x_axis_domain();
        this.set_y_axis_range();
        this.set_y_axis_domain();
        this.draw();
    };
    BalanceChart.prototype.set_x_axis_position = function (position) {
        var padding = this.padding;
        var canvas_height = this.canvas.height;
        if (position === void 0) {
            position = [padding.left, canvas_height - padding.bottom];
        }
        this.x_axis.set_position(position);
    };
    BalanceChart.prototype.set_x_axis_range = function (range) {
        if (range === void 0) {
            range = [0, this.canvas.width - this.padding.left - this.padding.right];
        }
        this.x_axis.set_range(range);
    };
    BalanceChart.prototype.set_x_axis_domain = function (domain) {
        if (domain === void 0) {
            domain = this.get_x_domain();
        }
        this.x_axis.set_domain(domain);
    };
    BalanceChart.prototype.set_y_axis_position = function (position) {
        var padding = this.padding;
        if (position === void 0) {
            position = [padding.left, padding.top];
        }
        this.y_axis.set_position(position);
    };
    BalanceChart.prototype.set_y_axis_range = function (range) {
        if (range === void 0) {
            range = [this.canvas.height - this.padding.top - this.padding.bottom, 0];
        }
        this.y_axis.set_range(range);
    };
    BalanceChart.prototype.set_y_axis_domain = function (domain) {
        if (domain === void 0) {
            domain = this.get_y_domain();
        }
        this.y_axis.set_domain(domain);
    };
    BalanceChart.prototype.draw = function () {
        this.draw_x_axis();
        this.draw_y_axis();
        this.draw_bars();
    };
    BalanceChart.prototype.get_x_domain = function () {
        var start = new Date(Date.parse(d3.min(this.balances, function (d) { return d.date; })));
        var end = new Date(Date.parse(d3.max(this.balances, function (d) { return d.date; })));
        start.setDate(start.getDate() - 0.5);
        end.setDate(end.getDate() + 0.5);
        return [start, end];
    };
    BalanceChart.prototype.get_y_domain = function () {
        var balance_min = d3.min(this.balances, function (d) { return d.balance; });
        var balance_max = d3.max(this.balances, function (d) { return d.balance; });
        var y_min = balance_min > 0 ? 0.9 * balance_min : 1.1 * balance_min;
        var y_max = balance_max > 0 ? 1.1 * balance_max : 0.9 * balance_max;
        return [y_min, y_max];
    };
    BalanceChart.prototype.draw_x_axis = function () {
        this.x_axis.draw();
    };
    BalanceChart.prototype.draw_y_axis = function () {
        this.y_axis.draw();
    };
    BalanceChart.prototype.draw_bars = function () {
        var that = this;
        var y_reference = null;
        var x_scale = this.x_axis.scale;
        var y_scale = this.y_axis.scale;
        var padding = this.padding;
        var balances = this.balances;
        var canvas_width = this.canvas.width;
        var plot_area = this.plot_area;
        if (y_scale.domain()[0] < 0 && y_scale.domain()[1] >= 0) {
            // 0 is within the y-axis range, set that as the reference
            y_reference = y_scale(0);
        }
        else if (y_scale.domain()[0] < 0) {
            // y-axis range is only negative, set reference to the top of the chart
            y_reference = y_scale.range()[1];
        }
        else {
            // y-axis range is only positive, set reference to the bottom of the chart
            y_reference = y_scale.range()[0];
        }
        function set_x(d) {
            var x_lower = new Date(d.date);
            x_lower.setDate(x_lower.getDate() - 0.45);
            return padding.left + x_scale(x_lower);
        }
        function set_y(d) {
            if (d.balance >= 0) {
                return padding.top + y_scale(d.balance);
            }
            else {
                return padding.top + y_reference;
            }
        }
        function set_height(d) {
            return Math.abs(y_scale(d.balance) - y_reference);
        }
        plot_area.selectAll('.bar')
            .data(balances, function (d) { return d.date; })
            .transition()
            .attr('x', set_x)
            .attr('width', 0.9 * (canvas_width - padding.left - padding.right) / balances.length)
            .attr('y', set_y)
            .attr('height', set_height);
        plot_area.selectAll('.bar')
            .data(balances, function (d) { return d.date; })
            .enter()
            .append('rect')
            .attr('class', 'bar')
            .attr('x', set_x)
            .attr('y', padding.top + y_reference)
            .attr('width', 0.9 * (canvas_width - padding.left - padding.right) / balances.length)
            .attr('date', function (d) { return d.date; })
            .attr('balance', function (d) { return d.balance; })
            .on('mouseover', tooltips.mouseover_callback)
            .on('mouseout', tooltips.mouseout_callback)
            .transition()
            .attr('y', set_y)
            .attr('height', set_height);
        plot_area.selectAll('.bar')
            .data(balances, function (d) { return d.date; })
            .exit()
            .transition()
            .attr('x', set_x)
            .attr('width', 0.9 * (canvas_width - padding.left - padding.right) / balances.length)
            .attr('y', y_reference)
            .attr('height', 0)
            .remove();
    };
    return BalanceChart;
}());
// ================
// Event triggers
// ================
function toISODateString(date) {
    return date.toISOString().slice(0, 10);
}
$(document).ready(function () {
    balance_chart = new BalanceChart(d3.select('#balance-chart'), balances);
    tooltips = new tooltip_1.ToolTip();
    balance_chart.draw();
});
$(document).ready(function () {
    $('#week-forward-form').on('submit', function (e) {
        var form = $(this);
        function success(d) {
            balances = d['data'];
            balance_chart.balances = balances;
            balance_chart.resize();
            $('body').attr('date_range_start', args[0].value);
            $('body').attr('date_range_end', args[1].value);
            var start_new = new Date(args[0].value);
            var end_new = new Date(args[1].value);
            start_new.setDate(start_new.getDate() + 7);
            end_new.setDate(end_new.getDate() + 7);
            var start_input = form.find('input[name="start"]');
            var end_input = form.find('input[name="end"]');
            start_input.val(toISODateString(start_new));
            end_input.val(toISODateString(end_new));
            var form_backward = $('#week-backward-form');
            var start_new = new Date(args[0].value);
            var end_new = new Date(args[1].value);
            start_new.setDate(start_new.getDate() - 7);
            end_new.setDate(end_new.getDate() - 7);
            var start_input = form_backward.find('input[name="start"]');
            var end_input = form_backward.find('input[name="end"]');
            start_input.val(toISODateString(start_new));
            end_input.val(toISODateString(end_new));
        }
        e.preventDefault();
        var url = '/get-balances';
        var args = form.serializeArray();
        $.get(url, args, success);
    });
    $('#week-backward-form').on('submit', function (e) {
        var form = $(this);
        function success(d) {
            balances = d['data'];
            balance_chart.balances = balances;
            balance_chart.resize();
            $('body').attr('date_range_start', args[0].value);
            $('body').attr('date_range_end', args[1].value);
            var start_new = new Date(args[0].value);
            var end_new = new Date(args[1].value);
            start_new.setDate(start_new.getDate() - 7);
            end_new.setDate(end_new.getDate() - 7);
            var start_input = form.find('input[name="start"]');
            var end_input = form.find('input[name="end"]');
            start_input.val(toISODateString(start_new));
            end_input.val(toISODateString(end_new));
            var form_forward = $('#week-forward-form');
            var start_new = new Date(args[0].value);
            var end_new = new Date(args[1].value);
            start_new.setDate(start_new.getDate() + 7);
            end_new.setDate(end_new.getDate() + 7);
            var start_input = form_forward.find('input[name="start"]');
            var end_input = form_forward.find('input[name="end"]');
            start_input.val(toISODateString(start_new));
            end_input.val(toISODateString(end_new));
        }
        e.preventDefault();
        var url = '/get-balances';
        var args = form.serializeArray();
        $.get(url, args, success);
    });
    $(window).resize(function () {
        balance_chart.resize();
    });
});

},{"./tooltip":2}],2:[function(require,module,exports){
"use strict";
exports.__esModule = true;
function ToolTip() {
    var that = this;
    this.tooltip = d3.select('#tooltip');
    this.mouseover_callback = function (d) {
        that.tooltip.transition()
            .duration(200)
            .style("opacity", .9);
        that.tooltip.style("opacity", 1);
        that.tooltip.html("<b>" + d.date + "</b>" + "<br>Â£" + d.balance.toFixed(2))
            .style("left", (d3.event.pageX) + "px")
            .style("top", (d3.event.pageY - 28) + "px");
        d3.select(this)
            .style('opacity', 0.6);
    };
    this.mouseout_callback = function (d) {
        that.tooltip.transition()
            .duration(500)
            .style("opacity", 0);
        d3.select(this)
            .style('opacity', 1);
    };
}
exports.ToolTip = ToolTip;

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJ3ZWJzaXRlL3N0YXRpYy93ZWJzaXRlL2hvbWUudHMiLCJ3ZWJzaXRlL3N0YXRpYy93ZWJzaXRlL3Rvb2x0aXAudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7OztBQ0FBLE9BQU8sQ0FBQyxHQUFHLENBQUMsU0FBUyxDQUFDLENBQUM7QUFFdkIsWUFBWTtBQUNaLFdBQVc7QUFDWCxZQUFZO0FBQ1oscUNBQW9DO0FBRXBDLElBQUksYUFBYSxHQUFHLElBQUksQ0FBQztBQUN6QixJQUFJLFFBQVEsR0FBRyxJQUFJLENBQUM7QUFNcEIsWUFBWTtBQUNaLFNBQVM7QUFDVCxZQUFZO0FBRVo7SUFJSSxnQkFBbUIsU0FBUztRQUFULGNBQVMsR0FBVCxTQUFTLENBQUE7UUFDL0IsSUFBSSxDQUFDLE1BQU0sR0FBRyxJQUFJLENBQUMsVUFBVSxFQUFFLENBQUM7UUFDaEMsSUFBSSxDQUFDLEtBQUssR0FBRyxJQUFJLENBQUMsU0FBUyxFQUFFLENBQUM7SUFDM0IsQ0FBQztJQUVELDBCQUFTLEdBQVQ7UUFDSCxNQUFNLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUM7SUFDNUMsQ0FBQztJQUVELDJCQUFVLEdBQVY7UUFDSCxNQUFNLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUM7SUFDN0MsQ0FBQztJQUVMLGFBQUM7QUFBRCxDQWpCQSxBQWlCQyxJQUFBO0FBRUQsWUFBWTtBQUNaLFNBQVM7QUFDVCxZQUFZO0FBRVo7SUFJSSxlQUFtQixTQUFTO1FBQVQsY0FBUyxHQUFULFNBQVMsQ0FBQTtRQUMvQixJQUFJLENBQUMsS0FBSyxHQUFHLEVBQUUsQ0FBQyxRQUFRLEVBQUUsQ0FBQztJQUN4QixDQUFDO0lBQUEsQ0FBQztJQUVGLHlCQUFTLEdBQVQs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LENBQUM7SUFFRixJQUFJLENBQUMsaUJBQWlCLEdBQUcsVUFBUyxDQUFDO1FBQ3RDLElBQUksQ0FBQyxPQUFPLENBQUMsVUFBVSxFQUFFO2FBQ2IsUUFBUSxDQUFDLEdBQUcsQ0FBQzthQUNiLEtBQUssQ0FBQyxTQUFTLEVBQUUsQ0FBQyxDQUFDLENBQUM7UUFDaEMsRUFBRSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUM7YUFDVixLQUFLLENBQUMsU0FBUyxFQUFFLENBQUMsQ0FBQyxDQUFBO0lBQ3JCLENBQUMsQ0FBQztBQUVOLENBQUM7QUFFUSwwQkFBTyIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9cmV0dXJuIGV9KSgpIiwiY29uc29sZS5sb2coJ2hvbWUuanMnKTtcblxuLy8gPT09PT09PT09XG4vLyBUb29sIFRpcFxuLy8gPT09PT09PT09XG5pbXBvcnQgeyBUb29sVGlwIH0gZnJvbSBcIi4vdG9vbHRpcFwiO1xuXG52YXIgYmFsYW5jZV9jaGFydCA9IG51bGw7XG52YXIgdG9vbHRpcHMgPSBudWxsO1xuXG5kZWNsYXJlIHZhciBiYWxhbmNlczogYW55W107XG5kZWNsYXJlIHZhciAkOiBhbnk7XG5kZWNsYXJlIHZhciBkMzogYW55O1xuXG4vLyA9PT09PT09PT1cbi8vIENhbnZhc1xuLy8gPT09PT09PT09XG5cbmNsYXNzIENhbnZhcyB7XG4gICAgd2lkdGg6IG51bWJlcjtcbiAgICBoZWlnaHQ6IG51bWJlcjtcblxuICAgIGNvbnN0cnVjdG9yKHB1YmxpYyBzZWxlY3Rpb24pe1xuXHR0aGlzLmhlaWdodCA9IHRoaXMuZ2V0X2hlaWdodCgpO1xuXHR0aGlzLndpZHRoID0gdGhpcy5nZXRfd2lkdGgoKTtcbiAgICB9XG5cbiAgICBnZXRfd2lkdGgoKTogbnVtYmVyIHtcblx0cmV0dXJuIHBhcnNlSW50KHRoaXMuc2VsZWN0aW9uLnN0eWxlKCd3aWR0aCcpKTtcdFxuICAgIH1cblxuICAgIGdldF9oZWlnaHQoKTogbnVtYmVyIHtcblx0cmV0dXJuIHBhcnNlSW50KHRoaXMuc2VsZWN0aW9uLnN0eWxlKCdoZWlnaHQnKSk7XG4gICAgfVxuICAgIFxufVxuXG4vLyA9PT09PT09PT1cbi8vIFgtQXhpc1xuLy8gPT09PT09PT09XG5cbmNsYXNzIFhBeGlzIHtcbiAgICBzY2FsZTtcbiAgICBwb3NpdGlvbjogW251bWJlciwgbnVtYmVyXTtcblxuICAgIGNvbnN0cnVjdG9yKHB1YmxpYyBzZWxlY3Rpb24pe1xuXHR0aGlzLnNjYWxlID0gZDMuc2NhbGVVdGMoKTtcbiAgICB9O1xuXG4gICAgc2V0X3JhbmdlKHJhbmdlOiBbbnVtYmVyLCBudW1iZXJdKTogdm9pZCB7XG5cdHRoaXMuc2NhbGUucmFuZ2UocmFuZ2UpXG4gICAgfVxuXG4gICAgc2V0X2RvbWFpbihkb21haW46IFtEYXRlLCBEYXRlXSk6IHZvaWQge1xuXHR0aGlzLnNjYWxlLmRvbWFpbihkb21haW4pO1xuICAgIH1cblxuICAgIHNldF9wb3NpdGlvbihwb3NpdGlvbjogW251bWJlciwgbnVtYmVyXSk6IHZvaWQge1xuXHR0aGlzLnBvc2l0aW9uID0gcG9zaXRpb247XG4gICAgfVxuXG4gICAgZHJhdygpOiB2b2lkIHtcblx0dmFyIHggPSB0aGlzLnBvc2l0aW9uWzBdO1xuXHR2YXIgeSA9IHRoaXMucG9zaXRpb25bMV07XG5cdHZhciBzY2FsZSA9IHRoaXMuc2NhbGU7XG5cdHRoaXMuc2VsZWN0aW9uLmF0dHIoJ3RyYW5zZm9ybScsICd0cmFuc2xhdGUoJyArIHggKyAnLCAnICsgeSArICcpJyk7XG5cdHRoaXMuc2VsZWN0aW9uLnRyYW5zaXRpb24oKS5jYWxsKGQzLmF4aXNCb3R0b20oc2NhbGUpKTtcblx0XG5cdHZhciBub3cgPSBuZXcgRGF0ZSgpO1xuXHR2YXIgdG9kYXkgPSBuZXcgRGF0ZShEYXRlLlVUQyhub3cuZ2V0RnVsbFllYXIoKSwgbm93LmdldE1vbnRoKCksIG5vdy5nZXREYXRlKCkpKTtcblx0dGhpcy5zZWxlY3Rpb25cblx0ICAgIC5zZWxlY3RBbGwoJ2cudGljayB0ZXh0Jylcblx0ICAgIC5maWx0ZXIoZnVuY3Rpb24oZCl7XG5cdFx0cmV0dXJuIGQuZ2V0VGltZSgpID09IHRvZGF5LmdldFRpbWUoKVxuXHQgICAgfSlcblx0ICAgIC5hdHRyKCdmaWxsJywgJ2JsdWUnKTtcblx0XG4gICAgfVxufVxuXG4vLyA9PT09PT09PT1cbi8vIFktQXhpc1xuLy8gPT09PT09PT09XG5cbmNsYXNzIFlBeGlze1xuICAgIHNjYWxlO1xuICAgIHBvc2l0aW9uOiBbbnVtYmVyLCBudW1iZXJdO1xuICAgIFxuICAgIGNvbnN0cnVjdG9yKHB1YmxpYyBzZWxlY3Rpb24pe1xuXHR0aGlzLnNjYWxlID0gZDMuc2NhbGVMaW5lYXIoKTtcbiAgICB9XG5cbiAgICBzZXRfcmFuZ2UocmFuZ2U6IFtudW1iZXIsIG51bWJlcl0pOiB2b2lkIHtcblx0dGhpcy5zY2FsZS5yYW5nZShyYW5nZSk7XG4gICAgfVxuXG4gICAgc2V0X2RvbWFpbihkb21haW46IFtudW1iZXIsIG51bWJlcl0pOiB2b2lkIHtcblx0dGhpcy5zY2FsZS5kb21haW4oZG9tYWluKTtcbiAgICB9XG5cbiAgICBzZXRfcG9zaXRpb24ocG9zaXRpb246IFtudW1iZXIsIG51bWJlcl0pOiB2b2lkIHtcblx0dGhpcy5wb3NpdGlvbiA9IHBvc2l0aW9uO1xuICAgIH1cblxuICAgIGRyYXcoKTogdm9pZCB7XG5cdHZhciB4ID0gdGhpcy5wb3NpdGlvblswXTtcblx0dmFyIHkgPSB0aGlzLnBvc2l0aW9uWzFdO1xuXHR2YXIgc2NhbGUgPSB0aGlzLnNjYWxlO1xuXHRmdW5jdGlvbiB0aWNrX2Zvcm1hdHRlcih0KXtcblx0ICAgIHJldHVybiAnwqMnICsgdC50b0xvY2FsZVN0cmluZygpXG5cdH1cblx0XG5cdHRoaXMuc2VsZWN0aW9uLmF0dHIoJ3RyYW5zZm9ybScsICd0cmFuc2xhdGUoJyArIHggKyAnLCAnICsgeSArICcpJyk7XG5cdHRoaXMuc2VsZWN0aW9uLnRyYW5zaXRpb24oKS5jYWxsKGQzLmF4aXNMZWZ0KHNjYWxlKS50aWNrRm9ybWF0KHRpY2tfZm9ybWF0dGVyKSk7XG4gICAgfVxufVxuXG4vLyA9PT09PT09PT09PT09PVxuLy8gQmFsYW5jZSBDaGFydFxuLy8gPT09PT09PT09PT09PT1cblxuY2xhc3MgQmFsYW5jZUNoYXJ0IHtcbiAgICBjYW52YXM6IENhbnZhcztcbiAgICBwbG90X2FyZWE7XG4gICAgeF9heGlzOiBYQXhpcztcbiAgICB5X2F4aXM6IFlBeGlzO1xuICAgIGNvbnN0cnVjdG9yKHB1YmxpYyBzZWxlY3Rpb24sXG5cdFx0cHVibGljIGJhbGFuY2VzOiBPYmplY3RbXSxcblx0XHRwdWJsaWMgcGFkZGluZyA9IHt0b3A6IDEwLCBsZWZ0OiA2MCwgcmlnaHQ6IDIwLCBib3R0b206IDQwfSl7XG5cdHRoaXMuY2FudmFzID0gbmV3IENhbnZhcyh0aGlzLnNlbGVjdGlvbi5zZWxlY3QoJyNjYW52YXMnKSk7XG5cdHRoaXMucGxvdF9hcmVhID0gdGhpcy5jYW52YXMuc2VsZWN0aW9uLnNlbGVjdCgnI3Bsb3QtYXJlYScpO1xuXHR0aGlzLnhfYXhpcyA9IG5ldyBYQXhpcyh0aGlzLmNhbnZhcy5zZWxlY3Rpb24uc2VsZWN0KCcjeC1heGlzJykpO1xuXHR0aGlzLnlfYXhpcyA9IG5ldyBZQXhpcyh0aGlzLmNhbnZhcy5zZWxlY3Rpb24uc2VsZWN0KCcjeS1heGlzJykpO1xuXHR0aGlzLnNldF94X2F4aXNfcG9zaXRpb24oKTtcblx0dGhpcy5zZXRfeF9heGlzX3JhbmdlKCk7XG5cdHRoaXMuc2V0X3hfYXhpc19kb21haW4oKTtcblx0dGhpcy5zZXRfeV9heGlzX3Bvc2l0aW9uKCk7XG5cdHRoaXMuc2V0X3lfYXhpc19yYW5nZSgpO1xuXHR0aGlzLnNldF95X2F4aXNfZG9tYWluKCk7XG4gICAgfVxuXG4gICAgcmVzaXplKCl7XG5cdHRoaXMuY2FudmFzLndpZHRoID0gdGhpcy5jYW52YXMuZ2V0X3dpZHRoKCk7XG5cdHRoaXMuY2FudmFzLmhlaWdodCA9IHRoaXMuY2FudmFzLmdldF9oZWlnaHQoKTtcblx0dGhpcy5zZXRfeF9heGlzX3JhbmdlKCk7XG5cdHRoaXMuc2V0X3hfYXhpc19kb21haW4oKTtcblx0dGhpcy5zZXRfeV9heGlzX3JhbmdlKCk7XG5cdHRoaXMuc2V0X3lfYXhpc19kb21haW4oKTtcblx0dGhpcy5kcmF3KCk7XG4gICAgfVxuXG5cbiAgICBzZXRfeF9heGlzX3Bvc2l0aW9uKHBvc2l0aW9uPzogW251bWJlciwgbnVtYmVyXSl7XG5cdHZhciBwYWRkaW5nID0gdGhpcy5wYWRkaW5nO1xuXHR2YXIgY2FudmFzX2hlaWdodCA9IHRoaXMuY2FudmFzLmhlaWdodDtcblx0aWYgKHBvc2l0aW9uID09PSB2b2lkIDApIHsgcG9zaXRpb24gPSBbcGFkZGluZy5sZWZ0LCBjYW52YXNfaGVpZ2h0IC0gcGFkZGluZy5ib3R0b21dOyB9XG5cdHRoaXMueF9heGlzLnNldF9wb3NpdGlvbihwb3NpdGlvbik7XG4gICAgfVxuICAgIFxuICAgIHNldF94X2F4aXNfcmFuZ2UocmFuZ2U/OiBbbnVtYmVyLCBudW1iZXJdKTogdm9pZCB7XG5cdGlmIChyYW5nZSA9PT0gdm9pZCAwKSB7IHJhbmdlID0gWzAsIHRoaXMuY2FudmFzLndpZHRoIC0gdGhpcy5wYWRkaW5nLmxlZnQgLSB0aGlzLnBhZGRpbmcucmlnaHRdOyB9XG5cdHRoaXMueF9heGlzLnNldF9yYW5nZShyYW5nZSk7XG4gICAgfVxuXG4gICAgc2V0X3hfYXhpc19kb21haW4oZG9tYWluPzogW0RhdGUsIERhdGVdKTogdm9pZCB7XG5cdGlmIChkb21haW4gPT09IHZvaWQgMCkgeyBkb21haW4gPSB0aGlzLmdldF94X2RvbWFpbigpOyB9XG5cdHRoaXMueF9heGlzLnNldF9kb21haW4oZG9tYWluKTtcbiAgICB9XG5cbiAgICBzZXRfeV9heGlzX3Bvc2l0aW9uKHBvc2l0aW9uPzogW251bWJlciwgbnVtYmVyXSk6IHZvaWQge1xuXHR2YXIgcGFkZGluZyA9IHRoaXMucGFkZGluZztcblx0aWYgKHBvc2l0aW9uID09PSB2b2lkIDApIHsgcG9zaXRpb24gPSAgW3BhZGRpbmcubGVmdCwgcGFkZGluZy50b3BdOyB9XG5cdHRoaXMueV9heGlzLnNldF9wb3NpdGlvbihwb3NpdGlvbik7XG4gICAgfVxuXG4gICAgc2V0X3lfYXhpc19yYW5nZShyYW5nZT86IFtudW1iZXIsIG51bWJlcl0pOiB2b2lkIHtcblx0aWYgKHJhbmdlID09PSB2b2lkIDApIHsgcmFuZ2UgPSBbdGhpcy5jYW52YXMuaGVpZ2h0IC0gdGhpcy5wYWRkaW5nLnRvcCAtIHRoaXMucGFkZGluZy5ib3R0b20sIDBdOyB9XG5cdHRoaXMueV9heGlzLnNldF9yYW5nZShyYW5nZSk7XG4gICAgfVxuXG4gICAgc2V0X3lfYXhpc19kb21haW4oZG9tYWluPzogW251bWJlciwgbnVtYmVyXSk6IHZvaWQge1xuXHRpZiAoZG9tYWluID09PSB2b2lkIDApIHsgZG9tYWluID0gdGhpcy5nZXRfeV9kb21haW4oKTsgfVxuXHR0aGlzLnlfYXhpcy5zZXRfZG9tYWluKGRvbWFpbik7XG4gICAgfVxuXG4gICAgZHJhdygpOiB2b2lkIHtcblx0dGhpcy5kcmF3X3hfYXhpcygpO1xuXHR0aGlzLmRyYXdfeV9heGlzKCk7XG5cdHRoaXMuZHJhd19iYXJzKCk7XG4gICAgfVxuXG4gICAgZ2V0X3hfZG9tYWluKCkgOiBbRGF0ZSwgRGF0ZV0ge1xuXHR2YXIgc3RhcnQ6IERhdGUgPSBuZXcgRGF0ZShEYXRlLnBhcnNlKGQzLm1pbih0aGlzLmJhbGFuY2VzLCBmdW5jdGlvbihkKXtyZXR1cm4gZC5kYXRlfSkpKTtcblx0dmFyIGVuZCA9IG5ldyBEYXRlKERhdGUucGFyc2UoZDMubWF4KHRoaXMuYmFsYW5jZXMsIGZ1bmN0aW9uKGQpe3JldHVybiBkLmRhdGV9KSkpO1xuXG5cdHN0YXJ0LnNldERhdGUoc3RhcnQuZ2V0RGF0ZSgpIC0gMC41KTtcblx0ZW5kLnNldERhdGUoZW5kLmdldERhdGUoKSArMC41KTtcblx0cmV0dXJuIFtzdGFydCwgZW5kXTtcblxuICAgIH1cblxuICAgIGdldF95X2RvbWFpbigpOiBbbnVtYmVyLCBudW1iZXJdIHtcblx0dmFyIGJhbGFuY2VfbWluID0gZDMubWluKHRoaXMuYmFsYW5jZXMsIGZ1bmN0aW9uKGQpe3JldHVybiBkLmJhbGFuY2V9KTtcblx0dmFyIGJhbGFuY2VfbWF4ID0gZDMubWF4KHRoaXMuYmFsYW5jZXMsIGZ1bmN0aW9uKGQpe3JldHVybiBkLmJhbGFuY2V9KTtcblx0dmFyIHlfbWluID0gYmFsYW5jZV9taW4gPiAwID8gMC45ICogYmFsYW5jZV9taW4gOiAxLjEgKiBiYWxhbmNlX21pbjtcblx0dmFyIHlfbWF4ID0gYmFsYW5jZV9tYXggPiAwID8gMS4xICogYmFsYW5jZV9tYXggOiAwLjkgKiBiYWxhbmNlX21heDtcblx0cmV0dXJuIFt5X21pbiwgeV9tYXhdO1xuXHRcbiAgICB9XG5cbiAgICBkcmF3X3hfYXhpcygpOiB2b2lkIHtcblx0dGhpcy54X2F4aXMuZHJhdygpO1xuICAgIH1cblxuICAgIGRyYXdfeV9heGlzKCk6IHZvaWQge1xuXHR0aGlzLnlfYXhpcy5kcmF3KCk7XG4gICAgfVxuXG4gICAgZHJhd19iYXJzKCk6IHZvaWQge1xuXHRcblx0dmFyIHRoYXQgPSB0aGlzO1xuXHR2YXIgeV9yZWZlcmVuY2UgPSBudWxsO1xuXHR2YXIgeF9zY2FsZSA9IHRoaXMueF9heGlzLnNjYWxlO1xuXHR2YXIgeV9zY2FsZSA9IHRoaXMueV9heGlzLnNjYWxlO1xuXHR2YXIgcGFkZGluZyA9IHRoaXMucGFkZGluZztcblx0dmFyIGJhbGFuY2VzID0gdGhpcy5iYWxhbmNlc1xuXHR2YXIgY2FudmFzX3dpZHRoID0gdGhpcy5jYW52YXMud2lkdGg7XG5cdHZhciBwbG90X2FyZWEgPSB0aGlzLnBsb3RfYXJlYTtcblx0XG5cdGlmKHlfc2NhbGUuZG9tYWluKClbMF0gPCAwICYmIHlfc2NhbGUuZG9tYWluKClbMV0gPj0gMCl7XG5cdCAgICAvLyAwIGlzIHdpdGhpbiB0aGUgeS1heGlzIHJhbmdlLCBzZXQgdGhhdCBhcyB0aGUgcmVmZXJlbmNlXG5cdCAgICB5X3JlZmVyZW5jZSA9IHlfc2NhbGUoMCk7XG5cdH0gZWxzZSBpZiAoeV9zY2FsZS5kb21haW4oKVswXSA8IDAgKSB7XG5cdCAgICAvLyB5LWF4aXMgcmFuZ2UgaXMgb25seSBuZWdhdGl2ZSwgc2V0IHJlZmVyZW5jZSB0byB0aGUgdG9wIG9mIHRoZSBjaGFydFxuXHQgICAgeV9yZWZlcmVuY2UgPSB5X3NjYWxlLnJhbmdlKClbMV07XG5cdH0gZWxzZSB7XG5cdCAgICAvLyB5LWF4aXMgcmFuZ2UgaXMgb25seSBwb3NpdGl2ZSwgc2V0IHJlZmVyZW5jZSB0byB0aGUgYm90dG9tIG9mIHRoZSBjaGFydFxuXHQgICAgeV9yZWZlcmVuY2UgPSB5X3NjYWxlLnJhbmdlKClbMF07XG5cdH1cblxuXHRmdW5jdGlvbiBzZXRfeChkKXtcblx0ICAgIHZhciB4X2xvd2VyID0gbmV3IERhdGUoZC5kYXRlKTtcblx0ICAgIHhfbG93ZXIuc2V0RGF0ZSh4X2xvd2VyLmdldERhdGUoKSAtIDAuNDUpO1xuXHQgICAgcmV0dXJuIHBhZGRpbmcubGVmdCArIHhfc2NhbGUoeF9sb3dlcik7XG5cdH1cblx0XG5cdGZ1bmN0aW9uIHNldF95KGQpe1xuXHQgICAgaWYoZC5iYWxhbmNlID49IDApe1xuXHRcdHJldHVybiBwYWRkaW5nLnRvcCArIHlfc2NhbGUoZC5iYWxhbmNlKTtcblx0ICAgIH0gZWxzZSB7XG5cdFx0cmV0dXJuIHBhZGRpbmcudG9wICsgeV9yZWZlcmVuY2U7XG5cdCAgICB9XG5cdH1cblxuXHRmdW5jdGlvbiBzZXRfaGVpZ2h0KGQpe1xuXHQgICAgcmV0dXJuIE1hdGguYWJzKHlfc2NhbGUoZC5iYWxhbmNlKSAtIHlfcmVmZXJlbmNlKVxuXHR9XG5cblx0cGxvdF9hcmVhLnNlbGVjdEFsbCgnLmJhcicpXG5cdCAgICAuZGF0YShiYWxhbmNlcywgZnVuY3Rpb24oZCl7cmV0dXJuIGQuZGF0ZX0pXG5cdCAgICAudHJhbnNpdGlvbigpXG5cdCAgICAuYXR0cigneCcsIHNldF94KVxuXHQgICAgLmF0dHIoJ3dpZHRoJywgMC45ICogKGNhbnZhc193aWR0aCAtIHBhZGRpbmcubGVmdCAtIHBhZGRpbmcucmlnaHQpIC8gYmFsYW5jZXMubGVuZ3RoKVxuXHQgICAgLmF0dHIoJ3knLCBzZXRfeSlcblx0ICAgIC5hdHRyKCdoZWlnaHQnLCBzZXRfaGVpZ2h0KTtcblx0XG5cdHBsb3RfYXJlYS5zZWxlY3RBbGwoJy5iYXInKVxuXHQgICAgLmRhdGEoYmFsYW5jZXMsIGZ1bmN0aW9uKGQpe3JldHVybiBkLmRhdGV9KVxuXHQgICAgLmVudGVyKClcblx0ICAgIC5hcHBlbmQoJ3JlY3QnKVxuXHQgICAgLmF0dHIoJ2NsYXNzJywgJ2JhcicpXG5cdCAgICAuYXR0cigneCcsIHNldF94KVxuXHQgICAgLmF0dHIoJ3knLCBwYWRkaW5nLnRvcCArIHlfcmVmZXJlbmNlKVxuXHQgICAgLmF0dHIoJ3dpZHRoJywgMC45ICogKGNhbnZhc193aWR0aCAtIHBhZGRpbmcubGVmdCAtIHBhZGRpbmcucmlnaHQpIC8gYmFsYW5jZXMubGVuZ3RoKVxuXHQgICAgLmF0dHIoJ2RhdGUnLCBmdW5jdGlvbihkKXtyZXR1cm4gZC5kYXRlfSlcblx0ICAgIC5hdHRyKCdiYWxhbmNlJywgZnVuY3Rpb24oZCl7cmV0dXJuIGQuYmFsYW5jZX0pXG5cdCAgICAub24oJ21vdXNlb3ZlcicsIHRvb2x0aXBzLm1vdXNlb3Zlcl9jYWxsYmFjaylcblx0ICAgIC5vbignbW91c2VvdXQnLCB0b29sdGlwcy5tb3VzZW91dF9jYWxsYmFjaylcblx0ICAgIC50cmFuc2l0aW9uKClcblx0ICAgIC5hdHRyKCd5Jywgc2V0X3kpXG5cdCAgICAuYXR0cignaGVpZ2h0Jywgc2V0X2hlaWdodCk7XG5cblx0cGxvdF9hcmVhLnNlbGVjdEFsbCgnLmJhcicpXG5cdCAgICAuZGF0YShiYWxhbmNlcywgZnVuY3Rpb24oZCl7cmV0dXJuIGQuZGF0ZX0pXG5cdCAgICAuZXhpdCgpXG5cdCAgICAudHJhbnNpdGlvbigpXG5cdCAgICAuYXR0cigneCcsIHNldF94KVxuXHQgICAgLmF0dHIoJ3dpZHRoJywgMC45ICogKGNhbnZhc193aWR0aCAtIHBhZGRpbmcubGVmdCAtIHBhZGRpbmcucmlnaHQpIC8gYmFsYW5jZXMubGVuZ3RoKVxuXHQgICAgLmF0dHIoJ3knLCB5X3JlZmVyZW5jZSlcblx0ICAgIC5hdHRyKCdoZWlnaHQnLCAwKVxuXHQgICAgLnJlbW92ZSgpO1xuXHRcbiAgICB9XG4gICAgXG59XG5cblxuLy8gPT09PT09PT09PT09PT09PVxuLy8gRXZlbnQgdHJpZ2dlcnNcbi8vID09PT09PT09PT09PT09PT1cblxuZnVuY3Rpb24gdG9JU09EYXRlU3RyaW5nKGRhdGUpe1xuICAgIHJldHVybiBkYXRlLnRvSVNPU3RyaW5nKCkuc2xpY2UoMCwgMTApO1xufVxuXG4kKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbigpe1xuICAgIGJhbGFuY2VfY2hhcnQgPSBuZXcgQmFsYW5jZUNoYXJ0KGQzLnNlbGVjdCgnI2JhbGFuY2UtY2hhcnQnKSwgYmFsYW5jZXMpO1xuICAgIHRvb2x0aXBzID0gbmV3IFRvb2xUaXAoKTtcbiAgICBiYWxhbmNlX2NoYXJ0LmRyYXcoKTtcbn0pO1xuXG4kKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbigpe1xuICAgIFxuICAgICQoJyN3ZWVrLWZvcndhcmQtZm9ybScpLm9uKCdzdWJtaXQnLCBmdW5jdGlvbihlKXtcblx0dmFyIGZvcm0gPSAkKHRoaXMpO1xuXHRcblx0ZnVuY3Rpb24gc3VjY2VzcyhkKXtcblx0ICAgIGJhbGFuY2VzID0gZFsnZGF0YSddO1xuXHQgICAgYmFsYW5jZV9jaGFydC5iYWxhbmNlcyA9IGJhbGFuY2VzO1xuXHQgICAgYmFsYW5jZV9jaGFydC5yZXNpemUoKTtcblx0ICAgICQoJ2JvZHknKS5hdHRyKCdkYXRlX3JhbmdlX3N0YXJ0JywgYXJnc1swXS52YWx1ZSk7XG5cdCAgICAkKCdib2R5JykuYXR0cignZGF0ZV9yYW5nZV9lbmQnLCBhcmdzWzFdLnZhbHVlKTtcblxuXHQgICAgdmFyIHN0YXJ0X25ldyA9IG5ldyBEYXRlKGFyZ3NbMF0udmFsdWUpO1xuXHQgICAgdmFyIGVuZF9uZXcgPSBuZXcgRGF0ZShhcmdzWzFdLnZhbHVlKTtcblx0ICAgIHN0YXJ0X25ldy5zZXREYXRlKHN0YXJ0X25ldy5nZXREYXRlKCkgKyA3KTtcblx0ICAgIGVuZF9uZXcuc2V0RGF0ZShlbmRfbmV3LmdldERhdGUoKSArIDcpO1xuXHQgICAgdmFyIHN0YXJ0X2lucHV0ID0gZm9ybS5maW5kKCdpbnB1dFtuYW1lPVwic3RhcnRcIl0nKTtcblx0ICAgIHZhciBlbmRfaW5wdXQgPSBmb3JtLmZpbmQoJ2lucHV0W25hbWU9XCJlbmRcIl0nKTtcblx0ICAgIHN0YXJ0X2lucHV0LnZhbCh0b0lTT0RhdGVTdHJpbmcoc3RhcnRfbmV3KSk7XG5cdCAgICBlbmRfaW5wdXQudmFsKHRvSVNPRGF0ZVN0cmluZyhlbmRfbmV3KSk7XG5cblx0ICAgIHZhciBmb3JtX2JhY2t3YXJkID0gJCgnI3dlZWstYmFja3dhcmQtZm9ybScpO1xuXHQgICAgdmFyIHN0YXJ0X25ldyA9IG5ldyBEYXRlKGFyZ3NbMF0udmFsdWUpO1xuXHQgICAgdmFyIGVuZF9uZXcgPSBuZXcgRGF0ZShhcmdzWzFdLnZhbHVlKTtcblx0ICAgIHN0YXJ0X25ldy5zZXREYXRlKHN0YXJ0X25ldy5nZXREYXRlKCkgLSA3KTtcblx0ICAgIGVuZF9uZXcuc2V0RGF0ZShlbmRfbmV3LmdldERhdGUoKSAtIDcpO1xuXHQgICAgdmFyIHN0YXJ0X2lucHV0ID0gZm9ybV9iYWNrd2FyZC5maW5kKCdpbnB1dFtuYW1lPVwic3RhcnRcIl0nKTtcblx0ICAgIHZhciBlbmRfaW5wdXQgPSBmb3JtX2JhY2t3YXJkLmZpbmQoJ2lucHV0W25hbWU9XCJlbmRcIl0nKTtcblx0ICAgIHN0YXJ0X2lucHV0LnZhbCh0b0lTT0RhdGVTdHJpbmcoc3RhcnRfbmV3KSk7XG5cdCAgICBlbmRfaW5wdXQudmFsKHRvSVNPRGF0ZVN0cmluZyhlbmRfbmV3KSk7XG5cblx0fVxuXHRcblx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHR2YXIgdXJsID0gJy9nZXQtYmFsYW5jZXMnO1xuXHR2YXIgYXJncyA9IGZvcm0uc2VyaWFsaXplQXJyYXkoKTtcblx0JC5nZXQodXJsLCBhcmdzLCBzdWNjZXNzKTtcblxuICAgIH0pO1xuICAgIFxuICAgICQoJyN3ZWVrLWJhY2t3YXJkLWZvcm0nKS5vbignc3VibWl0JywgZnVuY3Rpb24oZSl7XG5cdHZhciBmb3JtID0gJCh0aGlzKTtcblx0XG5cdGZ1bmN0aW9uIHN1Y2Nlc3MoZCl7XG5cdCAgICBiYWxhbmNlcyA9IGRbJ2RhdGEnXTtcblx0ICAgIGJhbGFuY2VfY2hhcnQuYmFsYW5jZXMgPSBiYWxhbmNlcztcblx0ICAgIGJhbGFuY2VfY2hhcnQucmVzaXplKCk7XG5cdCAgICAkKCdib2R5JykuYXR0cignZGF0ZV9yYW5nZV9zdGFydCcsIGFyZ3NbMF0udmFsdWUpO1xuXHQgICAgJCgnYm9keScpLmF0dHIoJ2RhdGVfcmFuZ2VfZW5kJywgYXJnc1sxXS52YWx1ZSk7XG5cblx0ICAgIHZhciBzdGFydF9uZXcgPSBuZXcgRGF0ZShhcmdzWzBdLnZhbHVlKTtcblx0ICAgIHZhciBlbmRfbmV3ID0gbmV3IERhdGUoYXJnc1sxXS52YWx1ZSk7XG5cdCAgICBzdGFydF9uZXcuc2V0RGF0ZShzdGFydF9uZXcuZ2V0RGF0ZSgpIC0gNyk7XG5cdCAgICBlbmRfbmV3LnNldERhdGUoZW5kX25ldy5nZXREYXRlKCkgLSA3KTtcblx0ICAgIHZhciBzdGFydF9pbnB1dCA9IGZvcm0uZmluZCgnaW5wdXRbbmFtZT1cInN0YXJ0XCJdJyk7XG5cdCAgICB2YXIgZW5kX2lucHV0ID0gZm9ybS5maW5kKCdpbnB1dFtuYW1lPVwiZW5kXCJdJyk7XG5cdCAgICBzdGFydF9pbnB1dC52YWwodG9JU09EYXRlU3RyaW5nKHN0YXJ0X25ldykpO1xuXHQgICAgZW5kX2lucHV0LnZhbCh0b0lTT0RhdGVTdHJpbmcoZW5kX25ldykpO1xuXG5cdCAgICB2YXIgZm9ybV9mb3J3YXJkID0gJCgnI3dlZWstZm9yd2FyZC1mb3JtJyk7XG5cdCAgICB2YXIgc3RhcnRfbmV3ID0gbmV3IERhdGUoYXJnc1swXS52YWx1ZSk7XG5cdCAgICB2YXIgZW5kX25ldyA9IG5ldyBEYXRlKGFyZ3NbMV0udmFsdWUpO1xuXHQgICAgc3RhcnRfbmV3LnNldERhdGUoc3RhcnRfbmV3LmdldERhdGUoKSArIDcpO1xuXHQgICAgZW5kX25ldy5zZXREYXRlKGVuZF9uZXcuZ2V0RGF0ZSgpICsgNyk7XG5cdCAgICB2YXIgc3RhcnRfaW5wdXQgPSBmb3JtX2ZvcndhcmQuZmluZCgnaW5wdXRbbmFtZT1cInN0YXJ0XCJdJyk7XG5cdCAgICB2YXIgZW5kX2lucHV0ID0gZm9ybV9mb3J3YXJkLmZpbmQoJ2lucHV0W25hbWU9XCJlbmRcIl0nKTtcblx0ICAgIHN0YXJ0X2lucHV0LnZhbCh0b0lTT0RhdGVTdHJpbmcoc3RhcnRfbmV3KSk7XG5cdCAgICBlbmRfaW5wdXQudmFsKHRvSVNPRGF0ZVN0cmluZyhlbmRfbmV3KSk7XG5cblx0fVxuXHRcblx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHR2YXIgdXJsID0gJy9nZXQtYmFsYW5jZXMnO1xuXHR2YXIgYXJncyA9IGZvcm0uc2VyaWFsaXplQXJyYXkoKTtcblx0JC5nZXQodXJsLCBhcmdzLCBzdWNjZXNzKTtcblxuICAgIH0pO1xuICAgIFxuICAgICQod2luZG93KS5yZXNpemUoZnVuY3Rpb24oKXtcblx0YmFsYW5jZV9jaGFydC5yZXNpemUoKTtcbiAgICB9KTtcblxufSk7XG4iLCJkZWNsYXJlIHZhciBkMzogYW55O1xuXG5mdW5jdGlvbiBUb29sVGlwKCl7XG4gICAgdmFyIHRoYXQgPSB0aGlzO1xuXG4gICAgdGhpcy50b29sdGlwID0gZDMuc2VsZWN0KCcjdG9vbHRpcCcpO1xuXG4gICAgdGhpcy5tb3VzZW92ZXJfY2FsbGJhY2sgPSBmdW5jdGlvbihkKXtcblx0dGhhdC50b29sdGlwLnRyYW5zaXRpb24oKVxuICAgICAgICAgICAgLmR1cmF0aW9uKDIwMClcbiAgICAgICAgICAgIC5zdHlsZShcIm9wYWNpdHlcIiwgLjkpO1xuXHR0aGF0LnRvb2x0aXAuc3R5bGUoXCJvcGFjaXR5XCIsIDEpO1xuXHR0aGF0LnRvb2x0aXAuaHRtbChcIjxiPlwiICsgZC5kYXRlICsgXCI8L2I+XCIgKyBcIjxicj7Co1wiICsgZC5iYWxhbmNlLnRvRml4ZWQoMikpXG4gICAgICAgICAgICAuc3R5bGUoXCJsZWZ0XCIsIChkMy5ldmVudC5wYWdlWCkgKyBcInB4XCIpXG4gICAgICAgICAgICAuc3R5bGUoXCJ0b3BcIiwgKGQzLmV2ZW50LnBhZ2VZIC0gMjgpICsgXCJweFwiKTtcblx0ZDMuc2VsZWN0KHRoaXMpXG5cdCAgICAuc3R5bGUoJ29wYWNpdHknLCAwLjYpXG4gICAgfTtcblxuICAgIHRoaXMubW91c2VvdXRfY2FsbGJhY2sgPSBmdW5jdGlvbihkKXtcblx0dGhhdC50b29sdGlwLnRyYW5zaXRpb24oKVxuICAgICAgICAgICAgLmR1cmF0aW9uKDUwMClcbiAgICAgICAgICAgIC5zdHlsZShcIm9wYWNpdHlcIiwgMCk7XG5cdGQzLnNlbGVjdCh0aGlzKVxuXHQgICAgLnN0eWxlKCdvcGFjaXR5JywgMSlcbiAgICB9O1xuICAgIFxufVxuXG5leHBvcnQgeyBUb29sVGlwIH07Il19
